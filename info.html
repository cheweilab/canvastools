<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ESL Testing Service</title>

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: Arial, sans-serif;
}

body {
    background: #f2f2f2;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.container {
    width: 1100px;
    height: 650px;
    background: #ffffff;
    display: flex;
    border: 1px solid #ccc;
}

/* LEFT PANEL */
.left-panel {
    width: 50%;
    background: #e9e9e9;
    padding: 60px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    border-right: 1px solid #ccc;
    text-align: center;
}

.illustration-placeholder {
    width: 250px;
    height: 250px;
    border: 2px dashed #bbb;
    margin-bottom: 40px;
}

.left-panel h1 {
    font-size: 28px;
    margin-bottom: 15px;
}

.left-panel p {
    font-size: 14px;
    max-width: 300px;
    color: #555;
}

/* RIGHT PANEL */
.right-panel {
    width: 50%;
    padding: 80px 100px;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.logo {
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 40px;
    text-align: center;
}

.form-group {
    margin-bottom: 20px;
    display: flex;
    flex-direction: column;
}

label {
    font-size: 14px;
    margin-bottom: 6px;
}

input, select, textarea {
    padding: 10px;
    border: 1px solid #bbb;
    border-radius: 4px;
}

.btn {
    margin-top: 20px;
    padding: 12px;
    background: #333;
    color: #fff;
    border: none;
    cursor: pointer;
    border-radius: 4px;
}

.btn:hover {
    background: #555;
}

.loader {
    border: 4px solid #eee;
    border-top: 4px solid #333;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
    margin: 20px auto;
}

@keyframes spin {
    100% { transform: rotate(360deg); }
}

.hidden {
    display: none;
}

.error {
    color: red;
    font-size: 13px;
    margin-top: 10px;
}

.exam-question {
    margin-top: 20px;
}

@media (max-width: 900px) {
    .container {
        flex-direction: column;
        width: 95%;
        height: auto;
    }

    .left-panel, .right-panel {
        width: 100%;
        padding: 40px;
    }
}
</style>
</head>

<body>

<div class="container">

    <!-- LEFT PANEL -->
    <div class="left-panel">
        <div class="illustration-placeholder"></div>
        <h1>English Help 寫作平台</h1>
        <p>免費線上寫作準備平台，助你學業成功。</p>
    </div>

    <!-- RIGHT PANEL -->
    <div class="right-panel">

        <div class="logo">TESTING SERVICE</div>

        <!-- STEP 1 -->
        <div id="step-request">
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="email" placeholder="Enter your email">
            </div>

            <div class="form-group">
                <label>Practice Topic</label>
                <select id="topic">
                    <option value="">Select Topic</option>
                    <option value="Speaking">Speaking</option>
                    <option value="Writing">Writing</option>
                    <option value="Reading">Reading</option>
                    <option value="Listening">Listening</option>
                </select>
            </div>

            <button class="btn" id="request-btn">Request Exam</button>
        </div>

        <!-- STEP 2 -->
        <div id="step-processing" class="hidden">
            <p>Preparing your exam...</p>
            <div class="loader"></div>
            <p>You will receive a login code via email.</p>
        </div>

        <!-- STEP 3 -->
        <div id="step-login" class="hidden">
            <div class="form-group">
                <label>Enter 6-Digit Login Code</label>
                <input type="text" id="login-code" maxlength="6" placeholder="123456">
            </div>
            <button class="btn" id="login-btn">Start Exam</button>
            <p class="error" id="error-msg"></p>
        </div>

        <!-- STEP 4 -->
        <div id="step-exam" class="hidden">
            <h3 id="exam-topic"></h3>
            <div class="exam-question">
                <p><strong>Question 1:</strong> Describe a memorable trip you have taken.</p>
                <textarea rows="6" id="exam-answer" placeholder="Write your response here..."></textarea>
            </div>
            <button id="submit-btn" class="btn">Submit Answer</button>
        </div>

    </div>
</div>

<script>
let generatedCode = "";
let selectedTopic = "";

const requestBtn = document.getElementById("request-btn");
const loginBtn = document.getElementById("login-btn");
const submitBtn = document.getElementById("submit-btn");

const stepRequest = document.getElementById("step-request");
const stepProcessing = document.getElementById("step-processing");
const stepLogin = document.getElementById("step-login");
const stepExam = document.getElementById("step-exam");

function showStep(step) {
    [stepRequest, stepProcessing, stepLogin, stepExam]
        .forEach(s => s.classList.add("hidden"));
    step.classList.remove("hidden");
}

/* REQUEST EXAM */
requestBtn.addEventListener("click", function () {

    const email = document.getElementById("email").value.trim();
    selectedTopic = document.getElementById("topic").value;

    if (!email.includes("@") || !selectedTopic) {
        alert("Please enter a valid email and select a topic.");
        return;
    }

    generatedCode = Math.floor(100000 + Math.random() * 900000).toString();

    console.log("Simulated Email:", email);
    console.log("Generated Code:", generatedCode);

    showStep(stepProcessing);

    setTimeout(() => {
        showStep(stepLogin);
    }, 2000);
});

/* LOGIN */
loginBtn.addEventListener("click", function () {

    const enteredCode = document.getElementById("login-code").value.trim();
    const errorMsg = document.getElementById("error-msg");

    if (!generatedCode) {
        errorMsg.innerText = "Please request an exam first.";
        return;
    }

    if (enteredCode === generatedCode) {
        document.getElementById("exam-topic").innerText = "Topic: " + selectedTopic;
        errorMsg.innerText = "";
        showStep(stepExam);
    } else {
        errorMsg.innerText = "Invalid code. Please try again.";
    }
});

/* CLEAR ERROR WHEN TYPING */
document.getElementById("login-code").addEventListener("input", () => {
    document.getElementById("error-msg").innerText = "";
});

/* SUBMIT EXAM */
submitBtn.addEventListener("click", function () {

    const answer = document.getElementById("exam-answer").value.trim();

    if (!answer) {
        alert("Please write your answer before submitting.");
        return;
    }

    alert("Exam submitted successfully.");

    // Redirect
    window.location.href = "https://cheweilab.github.io/canvastools/index.html";
});
</script>

</body>
</html>
